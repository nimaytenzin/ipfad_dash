<div class="px-4">
    <p>Tenant / <span class="font-semibold"> Profile</span></p>

    <div class="flex justify-content-center mt-6">
        <div
            *ngIf="!profileUri"
            style="height: 7rem; width: 7rem; border-radius: 100%"
            class="bg-blue-300 flex text-white justify-content-center align-items-center text-5xl"
        >
            {{ tenantDetails?.firstName[0] }}
        </div>
        <div
            *ngIf="profileUri"
            style="
                height: 7rem;
                width: 7rem;
                border-radius: 100%;
                background-size: cover;
            "
            [ngStyle]="{ 'background-image': 'url(' + profileUri + ')' }"
            class="bg-blue-300 flex text-white justify-content-center align-items-center text-5xl"
        ></div>
    </div>
    <div class="text-center my-2">
        <p class="text-2xl font-semibold">
            {{ tenantDetails?.firstName }} {{ tenantDetails?.middleName }}
            {{ tenantDetails?.lastName }}
        </p>
        <p class="text-sm">
            Member since {{ getReadableDate(tenantDetails?.createdAt) }}
        </p>
    </div>
    <div class="flex justify-content-center">
        <p-button
            [text]="true"
            icon="pi pi-camera"
            label="Change Profile"
            (click)="openUploadProfileModal()"
        ></p-button>
        <p-button
            [text]="true"
            label="Edit Details"
            icon="pi pi-pencil"
            (click)="showEditProfileDialog = true"
        ></p-button>
    </div>

    <p-divider></p-divider>
    <div>
        <p class="text-center text-2xl">Your Details</p>
        <div class="my-3">
            <p class="font-semibold text-lg">Full Name</p>
            <p>
                {{ tenantDetails?.firstName }} {{ tenantDetails?.middleName }}
                {{ tenantDetails?.lastName }}
            </p>
        </div>
        <div class="my-3">
            <p class="font-semibold text-lg">CID</p>
            <p>{{ tenantDetails?.cid }}</p>
        </div>
        <div class="my-3">
            <p class="font-semibold text-lg">Phone Number</p>
            <p>{{ tenantDetails?.phoneNumber }}</p>
        </div>
        <div class="my-3">
            <p class="font-semibold text-lg">Email</p>
            <p>
                {{ tenantDetails?.email }}
            </p>
        </div>

        <div class="my-3">
            <p class="font-semibold text-lg">Permanent Address</p>
            <p>
                {{ tenantDetails?.subadministrativeZone?.name }}
                {{ tenantDetails?.subadministrativeZone?.type }},
                {{ tenantDetails?.administrativeZone?.name }}
                {{ tenantDetails?.administrativeZone?.type }},
                {{ tenantDetails?.dzongkhag?.name }}
            </p>
        </div>
    </div>

    <div *ngIf="signatureUri" class="flex justify-content-end">
        <div>
            <img [src]="signatureUri" style="height: 70px" />
            <p>(Signature)</p>
        </div>
    </div>
    <p-divider></p-divider>

    <div class="flex justify-content-center">
        <p-button
            [text]="true"
            severity="secondary"
            label="Change PIN"
            (click)="updatePin()"
            icon="pi pi-lock"
        ></p-button>
        <p-button
            [text]="true"
            severity="secondary"
            label="Change Signature"
            (click)="showUploadSignatureModal = true"
            icon="pi pi-pencil"
        ></p-button>
    </div>
</div>

<p-dialog
    header="Edit Profile"
    [modal]="true"
    [(visible)]="showEditProfileDialog"
    [style]="{ width: '25rem' }"
>
    <span class="p-text-secondary block mb-5">Update your information.</span>
    <form [formGroup]="editProfileForm" class="p-fluid">
        <div class="mb-3">
            <label for="username">First Name</label>
            <input
                pInputText
                id="username"
                formControlName="firstName"
                class="flex-auto mt-2"
                autocomplete="off"
            />
        </div>
        <div class="mb-3">
            <label for="username">Middle Name</label>
            <input
                pInputText
                id="username"
                formControlName="middleName"
                class="flex-auto mt-2"
                autocomplete="off"
            />
        </div>
        <div class="mb-3">
            <label for="username">Last Name</label>
            <input
                pInputText
                id="username"
                formControlName="lastName"
                class="flex-auto mt-2"
                autocomplete="off"
            />
        </div>
        <div class="mb-3">
            <label for="username">CID</label>
            <input
                pInputText
                id="username"
                formControlName="cid"
                class="flex-auto mt-2"
                autocomplete="off"
            />
        </div>
        <div class="mb-3">
            <label for="username">Phone Number</label>
            <input
                pInputText
                id="username"
                formControlName="phoneNumber"
                class="flex-auto mt-2"
                autocomplete="off"
            />
        </div>
        <div class="mb-3">
            <label for="username">Email</label>
            <input
                pInputText
                id="username"
                formControlName="email"
                class="flex-auto mt-2"
                autocomplete="off"
            />
        </div>

        <div class="mb-3">
            <label for="username">Dzongkhag</label>
            <p-dropdown
                [options]="dzongkhags"
                formControlName="dzongkhagId"
                optionLabel="name"
                optionValue="id"
                placeholder="Dzongkhag"
            />
        </div>
        <div class="mb-3">
            <label for="username">Administrative Zone</label>
            <p-dropdown
                [options]="administrativeZones"
                formControlName="administrativeZoneId"
                optionLabel="name"
                optionValue="id"
                placeholder="Administrative Zone"
            />
        </div>
        <div class="mb-3">
            <label for="username">Sub Administrative Zone</label>
            <p-dropdown
                [options]="subAdministrativeZones"
                formControlName="subAdministrativeZoneId"
                optionLabel="name"
                optionValue="id"
                placeholder="Sub Administrative Zone"
            />
        </div>

        <div class="flex justify-content-end gap-2">
            <p-button
                label="Cancel"
                severity="secondary"
                (click)="showEditProfileDialog = false"
            />
            <p-button label="Save" (click)="updateProfileDetails()" />
        </div>
    </form>
</p-dialog>

<p-dialog
    header="Upload Profile Picture"
    [modal]="true"
    [(visible)]="showUploadProfile"
    [style]="{ width: '40rem' }"
>
    <span class="p-text-secondary block mb-5">Select and Upload.</span>
    <p-fileUpload
        name="demo[]"
        (onSelect)="onSelect($event)"
        (onBeforeUpload)="onUpload($event)"
        [multiple]="false"
        accept="image/*"
        maxFileSize="10000000"
    >
    </p-fileUpload>
</p-dialog>

<p-dialog
    header="Upload Signature"
    [modal]="true"
    [(visible)]="showUploadSignatureModal"
    [style]="{ width: '40rem' }"
>
    <span class="p-text-secondary block mb-5">
        Signature must be in transaprent background.</span
    >

    <p-fileUpload
        name="demo[]"
        (onSelect)="onSignatureSelect($event)"
        (onBeforeUpload)="onSignatureUpload($event)"
        [multiple]="false"
        accept="image/*"
        maxFileSize="10000000"
    >
    </p-fileUpload>
</p-dialog>
