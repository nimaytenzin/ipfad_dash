<div>
    <div class="flex justify-content-between my-4">
        <p class="text-xl">Plots Master Table</p>
        <div class="flex gap-2">
            <p-button
                label="Plot"
                icon="pi pi-plus"
                (click)="openCreatePlotModal()"
                size="small"
            ></p-button>
            <p-button
                label="Download Excel"
                icon="pi pi-file-excel"
                size="small"
                (click)="downloadMasterTable()"
            ></p-button>
        </div>
    </div>

    <p-table [value]="plots" styleClass="p-datatable-striped">
        <ng-template pTemplate="header">
            <tr>
                <th>Plot Id</th>
                <th>Plot Category</th>
                <th>Location</th>

                <th>Thram No</th>
                <th>Owner</th>

                <th>Net Area</th>

                <th>Lap Name</th>

                <th>Precinct Name</th>

                <th>Buildings</th>
                <th></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-plot>
            <tr>
                <td>
                    <p
                        class="text-blue-600 hover:underline cursor-pointer"
                        (click)="viewPlotsSpatially(plot)"
                    >
                        {{ plot.plotId }}
                    </p>
                </td>
                <td>{{ plot.plotCategory }}</td>
                <td>
                    {{ plot.thram?.dzongkhag?.name }},
                    {{ plot.thram?.administrativeZone?.name }},
                    {{ plot.thram?.subAdministrativeZone?.name }}
                </td>
                <td>{{ plot.thram?.thramNo }}</td>
                <td>
                    <p *ngFor="let owner of plot.thram.owners">
                        - {{ owner.nameEnglish }}/{{ owner.nameDzongkha }}
                    </p>
                </td>
                <td>{{ plot.netArea }} {{ plot.areaUnit }}</td>

                <td>{{ plot.lapName }}/ {{ plot.lapCode }}</td>

                <td>{{ plot.precinctName }} /{{ plot.precinctCode }}</td>

                <td>
                    <div>
                        <p *ngIf="!plot.buildings.length">No Buildings Added</p>
                        <p
                            *ngFor="let building of plot.buildings"
                            class="cursor-pointer font-semibold hover:underline"
                            (click)="navigateToBuilding(building.id)"
                        >
                            - {{ building.name }}
                        </p>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
