<form [formGroup]="createBuildingForm" class="p-fluid p-2">
    <div class="grid">
        <p class="col-12 font-semibold">
            Plot Details *A building may occupy one or more plot.
        </p>
        <div class="mt-1 px-4">
            <label for="zhichar">Plot ID</label>
            <div class="flex mt-2 mb-2 gap-4 align-items-center">
                <input
                    pInputText
                    id="zhichar"
                    formControlName="plotId"
                    type="text"
                    class="flex-1"
                    (input)="convertToUppercase($event)"
                />
                <p-button
                    label="Check And Add"
                    size="small"
                    [loading]="checkingPlot"
                    (click)="checkPlotDetailsAndAdd()"
                ></p-button>
            </div>
        </div>

        <div *ngIf="plotMappings.length" class="grid">
            <div class="col-12 text-xl">
                <p class="">Plot Mapping</p>
                <div *ngFor="let plot of plotMappings" class="font-bold">
                    <p>
                        {{ plot.plotId }}
                        <span
                            class="cursor-pointer hover:underline text-red-600"
                            (click)="removePlotMapping(plot)"
                            >-remove</span
                        >
                    </p>
                </div>
            </div>
            <p class="col-12 font-semibold">
                Linkage with Building Information System(www.zhichar.bt)
            </p>
            <hr class="col-12 m-0 p-0" />

            <div class="field col-12 md:col-4">
                <label for="zhichar">Zhichar Building ID</label>

                <p-inputNumber
                    formControlName="zhicharBuildingId"
                    mode="decimal"
                    (keyup)="getZhicharBuildingInformation($event)"
                    inputId="withoutgrouping"
                    [useGrouping]="false"
                />

                <div
                    *ngIf="
                        createBuildingForm.get('zhicharBuildingId')?.invalid &&
                        createBuildingForm.get('zhicharBuildingId')?.touched
                    "
                >
                    <small>Zhichar Building ID is required.</small>
                </div>
            </div>

            <div class="field col-12 md:col-4">
                <label for="qrId">Zhichar Qr ID</label>
                <input
                    pInputText
                    id="qrId"
                    type="text"
                    formControlName="zhicharQrUuid"
                />
            </div>

            <p class="col-12 font-semibold">Physical Features</p>
            <hr class="col-12 m-0 p-0" />

            <div class="field col-12 md:col-4">
                <label for="buildingType">Building Type</label>
                <p-dropdown
                    [options]="buildingTypes"
                    formControlName="buildingType"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="jamthogs">Jamthogs*</label>
                <p-dropdown
                    [options]="numberedDropDownOptions"
                    formControlName="jamthogCount"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="attic">Attic*</label>

                <p-dropdown
                    [options]="numberedDropDownOptions"
                    formControlName="atticCount"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="regularFloors">Regular Floors*</label>
                <p-dropdown
                    [options]="numberedDropDownOptions"
                    formControlName="regularFloorCount"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="stilts">Stilts*</label>
                <p-dropdown
                    [options]="numberedDropDownOptions"
                    formControlName="stiltCount"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="basement">Basement*</label>
                <p-dropdown
                    [options]="numberedDropDownOptions"
                    formControlName="basementCount"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-6">
                <label for="buildingArea">Building Area</label>

                <p-inputGroup>
                    <input
                        pInputText
                        id="buildingArea"
                        formControlName="areaSqM"
                    />
                    <p-inputGroupAddon> Sq. M </p-inputGroupAddon>
                </p-inputGroup>
            </div>

            <p class="col-12 font-semibold">Address and Location</p>
            <hr class="col-12 m-0 p-0" />

            <div class="field col-12 md:col-4">
                <label for="latitude">Latitude*</label>
                <input
                    pInputText
                    id="latitude"
                    type="text"
                    formControlName="latitude"
                />
            </div>

            <div class="field col-12 md:col-4">
                <label for="longitude">Longitude*</label>
                <input
                    pInputText
                    id="longitude"
                    type="text"
                    formControlName="longitude"
                />
            </div>
            <hr class="col-12 m-0 p-0" />

            <div class="field col-12 md:col-4">
                <label for="buildingName">Building Name</label>
                <input
                    pInputText
                    id="buildingName"
                    type="text"
                    formControlName="name"
                />
            </div>

            <div class="field col-12 md:col-4">
                <label for="buildingNumber">Building Number</label>
                <input
                    pInputText
                    id="buildingNumber"
                    type="text"
                    formControlName="buildingNumber"
                />
            </div>

            <div class="field col-12 md:col-4">
                <label for="address">Address</label>
                <input
                    pInputText
                    id="address"
                    type="text"
                    formControlName="address"
                />
            </div>

            <div class="field col-12 md:col-4">
                <label for="landmark">Land Mark</label>
                <textarea
                    pInputTextarea
                    id="landmark"
                    formControlName="landmark"
                    rows="1"
                ></textarea>
            </div>
            <hr class="col-12 m-0 p-0" />

            <div class="field col-12 md:col-4">
                <label for="dzongkhag">Dzongkhag* <br /> </label>
                <p-dropdown
                    [options]="dzongkhags"
                    optionLabel="name"
                    optionValue="id"
                    (onChange)="dzongkhagSelected($event)"
                    formControlName="dzongkhagId"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="thromde">Thromde/Gewog* </label>
                <p-dropdown
                    [options]="admninistrativeZones"
                    optionLabel="name"
                    optionValue="id"
                    (onChange)="administrativeZoneSelected($event)"
                    formControlName="administrativeZoneId"
                ></p-dropdown>
            </div>

            <div class="field col-12 md:col-4">
                <label for="locality">Locality/Chiwog* </label>
                <p-dropdown
                    [options]="subAdministrativeZones"
                    optionLabel="name"
                    optionValue="id"
                    formControlName="subadminsitrativeZoneId"
                ></p-dropdown>
            </div>

            <div class="col-12 md:12 flex align-items-center gap-3">
                <p-checkbox
                    formControlName="isActive"
                    binary="true"
                    inputId="ny"
                ></p-checkbox>
                <label for="ny"
                    >Is the building Currently Active in the system?*</label
                >
            </div>

            <div class="flex justify-content-end gap-2">
                <p-button
                    (click)="createBuilding()"
                    type="submit"
                    [disabled]="createBuildingForm.invalid"
                    label="Create Building"
                ></p-button>
                <p-button
                    severity="secondary"
                    label="Cancel"
                    (click)="close()"
                ></p-button>
            </div>
        </div>
    </div>
</form>
